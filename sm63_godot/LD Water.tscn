[gd_scene load_steps=6 format=3]

[ext_resource type="Script" path="res://xfl_parse/symbol_item/symbol_item.gd" id="1_vtpv8"]

[sub_resource type="Animation" id="Animation_st6ex"]
length = 0.0666667
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Layer 2/Frame 0:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.0333333),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [true, false]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Layer 2/Frame 1:visible")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.0333333, 0.0666667),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [false, true, false]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Layer 1/Frame 0:visible")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 0.0333333),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [true, false]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("Layer 1/Frame 1:visible")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0, 0.0333333, 0.0666667),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [false, true, false]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_hyhy7"]
_data = {
"Default": SubResource("Animation_st6ex")
}

[sub_resource type="GDScript" id="GDScript_s3kfo"]
script/source = "extends Node
# if (WaterDeepness == undefined) {
# 	WaterDeepness = 400;
# }
# if (WaterLength == undefined) {
# 	WaterLength = 500;
# }
# if (polygons == undefined) {
# 	polygons = Math.round(WaterLength/10)+1;
# }
# if (_root.BGquality == \"LOW\") {
# 	polygons = Math.round(polygons*0.5);
# }
# if (_root.BGquality == \"MEDIUM\") {
# 	polygons = Math.round(polygons*0.75);
# }
# if (randomwave == undefined) {
# 	randomwave = 1;
# }
# if (waterstength == undefined) {
# 	waterstength = 0.3;
# }
# if (redcolor == undefined) {
# 	redcolor = 40;
# }
# if (greencolor == undefined) {
# 	greencolor = 128;
# }
# if (bluecolor == undefined) {
# 	bluecolor = 215;
# }
# if (alpha == undefined) {
# 	alpha = 50;
# }
# if (graphics == undefined) {
# 	graphics = false;
# }
# //_rotation = 0;    
# "

[sub_resource type="GDScript" id="GDScript_cykn1"]
script/source = "extends Node
# this.pts = [];
# for (var i = 0; i<polygons; ++i) {
# 	this.pts[i] = {x:(i/polygons)*WaterLength, y:0, fx:0, fy:0, vx:0, vy:0, restLen:.5*(WaterLength/polygons), jy:0};
# }
# onEnterFrame = function () {
# 	if (_root.PauseGame == false) {
# 		for (var i = 0; i<polygons; ++i) {
# 			this.pts[i].fx = 0;
# 			if (Math.random()<0.1) {
# 				this.pts[i].fy += Math.random()*2-1;
# 			} else {
# 				this.pts[i].fy = 0;
# 			}
# 		}
# 		//
# 		if (Math.abs(_root.Course.Char.yspeed)>5 && Math.abs(_root.Course.Char._y-(_y+_root.Course.FrontGFX._y))<20) {
# 			if (rot == undefined || rot == 0 || rot == 180) {
# 				X = _root.Course.Char._x-(_x+_root.Course.FrontGFX._x)+_root.Course.Char.xspeed;
# 			} else {
# 				X = _root.Course.Char._y-(_y+_root.Course.FrontGFX._y)+_root.Course.Char.yspeed;
# 			}
# 			marioI = Math.round(((X)/WaterLength*(polygons)));
# 			if (_root.Course.Char.yspeed>0) {
# 				this.pts[marioI].fy = _root.Course.Char.yspeed/2;
# 			} else {
# 				this.pts[marioI].fy = _root.Course.Char.yspeed/3;
# 			}
# 			this.pts[marioI].fx += _root.Course.Char.xspeed/5;
# 			for (i=1; i<3; ++i) {
# 				if (rot == undefined || rot == 0) {
# 					this.pts[mouseI+i].fy -= (_root.Course.Char.yspeed/15)/i;
# 					this.pts[mouseI-i].fy -= (_root.Course.Char.yspeed/15)/i;
# 					this.pts[marioI].fx += (_root.Course.Char.xspeed/10)/i;
# 				} else if (rot == 90) {
# 					this.pts[mouseI+i].fy -= (_root.Course.Char.xspeed/15)/i;
# 					this.pts[mouseI-i].fy -= (_root.Course.Char.xspeed/15)/i;
# 					this.pts[marioI].fx += (_root.Course.Char.yspeed/10)/i;
# 				} else if (rot == -90) {
# 					this.pts[mouseI+i].fy += (_root.Course.Char.xspeed/15)/i;
# 					this.pts[mouseI-i].fy += (_root.Course.Char.xspeed/15)/i;
# 					this.pts[marioI].fx -= (_root.Course.Char.yspeed/10)/i;
# 				} else {
# 					this.pts[mouseI+i].fy += (_root.Course.Char.yspeed/15)/i;
# 					this.pts[mouseI-i].fy += (_root.Course.Char.yspeed/15)/i;
# 					this.pts[marioI].fx -= (_root.Course.Char.xspeed/10)/i;
# 					// rot = 180
# 				}
# 			}
# 		}
# 		//    
# 		for (i=0; i<this.pts.length-1; ++i) {
# 			var pt1 = this.pts[i];
# 			var pt2 = this.pts[i+1];
# 			var dx = pt2.x-pt1.x;
# 			var dy = pt2.y-pt1.y;
# 			var dist = Math.sqrt(dx*dx+dy*dy);
# 			var f1 = waterstength*(dist-pt1.restLen);
# 			var spr_fx = f1*dx/dist;
# 			var spr_fy = f1*dy/dist;
# 			if (i != 0) {
# 				pt1.fx += spr_fx;
# 				pt1.fy += spr_fy;
# 			}
# 			if (i != this.pts.length-2) {
# 				pt2.fx -= spr_fx;
# 				pt2.fy -= spr_fy;
# 			}
# 		}
# 		this.clear();
# 		r = Math.floor(redcolor);
# 		g = Math.floor(greencolor);
# 		b = Math.floor(bluecolor);
# 		this.clr = (r << 16 | g << 8 | b);
# 		this.beginFill(this.clr, alpha);
# 		this.moveTo(this.pts[0].x, this.pts[0].y);
# 		for (i=1; i<this.pts.length-1; ++i) {
# 			pt = this.pts[i];
# 			pt.vx *= .85;
# 			pt.vy *= .85;
# 			pt.vx += pt.fx;
# 			pt.vy += pt.fy;
# 			pt.x += pt.vx;
# 			pt.y += pt.vy;
# 			this.lineTo(pt.x, pt.y);
# 		}
# 		i = this.pts.length-1;
# 		this.lineTo(this.pts[i].x, this.pts[i].y);
# 		//this.lineTo(this.pts[i].x, this.deep);
# 		//this.lineTo(this.pts[0].x, this.deep);
# 		this.lineTo(this.pts[i].x, WaterDeepness);
# 		this.lineTo(this.pts[0].x, WaterDeepness);
# 		this.lineTo(this.pts[0].x, this.pts[0].y);
# 		this.endFill();
# 	}
# };
# stop();
# "

[node name="LD Water" type="Node2D"]
script = ExtResource("1_vtpv8")
source_xml = "res://sm63/LIBRARY/LD Water.xml"
linkage = "LDWater"
linkage_export = true
regenerate = false

[node name="Timeline" type="AnimationPlayer" parent="."]
libraries = {
"Timeline": SubResource("AnimationLibrary_hyhy7")
}

[node name="Layer 1" type="Node2D" parent="."]

[node name="Frame 0" type="Node2D" parent="Layer 1"]

[node name="Frame 1" type="Node2D" parent="Layer 1"]
visible = false

[node name="Layer 2" type="Node2D" parent="."]

[node name="Frame 0" type="Node2D" parent="Layer 2"]

[node name="AS2" type="Node" parent="Layer 2/Frame 0"]
script = SubResource("GDScript_s3kfo")

[node name="Frame 1" type="Node2D" parent="Layer 2"]
visible = false

[node name="AS2" type="Node" parent="Layer 2/Frame 1"]
script = SubResource("GDScript_cykn1")
